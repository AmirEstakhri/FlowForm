{% extends 'base.html' %}

{% block title %}Send Form{% endblock %}

{% block head %}{% load static%}
    <link rel="stylesheet" href="{% static 'css/send_form.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <h1>Send Form: {{ form.title }}</h1>

    <!-- Display messages if any -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <!-- Form Details -->
    <div class="form-details">
        <p><strong>Title:</strong> {{ form.title }}</p>
        <p><strong>Sender's Signature:</strong> {{ form.sender_signature }}</p>
        <p><strong>Receiver:</strong> {{ form.receiver|default:"Not assigned" }}</p>
        <p><strong>Content:</strong> {{ form.content }}</p>
        <p><strong>Priority:</strong> {{ form.priority }}</p>
    </div>

    <!-- Form for Assigning Allowed Managers -->
    {% if user.role == 'manager' %}
        <form method="post" class="assign-form">
            {% csrf_token %}
            
            <h3>Assign Allowed Managers</h3>
            <p>Select managers from the allowed list.</p>

            <!-- Assign to Allowed Managers -->
            <label for="allowed_managers">Assign to Allowed Manager(s)</label>
            <select name="allowed_managers" id="allowed_managers" class="form-select" multiple>
                <option value="">Select Allowed Managers</option>
                
                {% for manager in allowed_managers %}
                    <option value="{{ manager.id }}">{{ manager.username }}</option>
                {% endfor %}
            </select>

            <button type="submit" class="btn btn-primary">Assign Form</button>
        </form>
    {% else %}
        <p>You do not have permission to assign forms.</p>
    {% endif %}

    <!-- Navigation Links -->
    <div class="navigation-links">
        <a href="{% url 'form_list' %}" class="btn btn-secondary">Back to Form List</a>
        <a href="{% url 'homepage' %}" class="btn btn-secondary">Home</a>
    </div>
</div>
{% endblock %}
